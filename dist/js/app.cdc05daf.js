(function(e){function t(t){for(var a,o,l=t[0],r=t[1],d=t[2],c=0,f=[];c<l.length;c++)o=l[c],s[o]&&f.push(s[o][0]),s[o]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,d||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,l=1;l<n.length;l++){var r=n[l];0!==s[r]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={app:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=r;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"0601":function(e,t,n){"use strict";var a=n("6b30"),s=n.n(a);s.a},"096a":function(e,t,n){},"272b":function(e,t,n){"use strict";var a=n("9859"),s=n.n(a);s.a},"3f36":function(e,t,n){},"451b":function(e,t,n){"use strict";var a=n("096a"),s=n.n(a);s.a},"47e2":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"100%"},attrs:{id:"app"}},[n("el-header",{staticStyle:{padding:"0"}},[n("el-menu",{directives:[{name:"show",rawName:"v-show",value:this.$session.exists(),expression:"this.$session.exists()"}],staticClass:"el-menu",attrs:{mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:!0}},[n("el-menu-item",{attrs:{index:"/"}},[e._v("Домой")]),n("el-submenu",{directives:[{name:"show",rawName:"v-show",value:this.$session.get("nasyanika"),expression:"this.$session.get('nasyanika')"}],attrs:{index:"/admin/"}},[n("template",{slot:"title"},[e._v("Административная часть")]),n("el-menu-item",{attrs:{index:"/admin/contact/"}},[e._v("Управление контактами")]),n("el-menu-item",{attrs:{index:"/admin/all-contact/"}},[e._v("Управление всеми контактами")]),n("el-menu-item",{attrs:{index:"/admin/task/"}},[e._v("Управление задачами")]),n("el-menu-item",{attrs:{index:"/admin/event/"}},[e._v("Управление мероприятиями")]),n("el-menu-item",{attrs:{index:"/admin/edu/"}},[e._v("Управление учебными заведениями")]),n("el-menu-item",{attrs:{index:"/admin/edu-type/"}},[e._v("Управление типами учебных заведений")]),n("el-menu-item",{attrs:{index:"/admin/type-add/"}},[e._v("Управление типами добавления")]),n("el-menu-item",{attrs:{index:"/admin/status-contact/"}},[e._v("Управление статусами контактов")]),n("el-menu-item",{attrs:{index:"/admin/status-task/"}},[e._v("Управление статусами задач")])],2),n("el-menu-item",{attrs:{index:"/sender/"}},[e._v("Рассылки")]),n("el-menu-item",{attrs:{index:"/logout/"}},[e._v("Выйти ("+e._s(e.username)+") ")])],1),n("div",{staticClass:"line"})],1),n("el-container",[n("el-main",{staticStyle:{height:"100%"}},[n("router-view")],1)],1)],1)},i=[],o=n("bc3a"),l=n.n(o),r=l.a.create({}),d={name:"app",data:function(){return{year:(new Date).getFullYear()}},computed:{username:function(){return this.$session.get("username")}},created:function(){var e=this;this.getAuth()&&this.$router.push("/");var t=this.$loading({lock:!0,text:"Загрузка данных"}),n=["eduType","edu","contact","statusContact","statusTask","typeAdd","task","event","user"];this.$socket.emit("init",{ent:n}),this.sockets.subscribe("inited",function(n){e.$store.dispatch("updateFields").then(function(){return t.close()}),e.sockets.unsubscribe("inited")})},beforeUpdate:function(){this.getAuth()},methods:{checkLogout:function(){var e=this;this.$confirm("Точно выйти?","Подтверждение",{confirmButtonText:"Выйти",cancelButtonText:"Отмена",type:"warning"}).then(function(){e.$router.push("/logout/")})},getAuth:function(){return this.$session.exists()?this.$session.get("token")?(console.log("have token"),r.defaults.headers.common["Authorization"]="Token "+this.$session.get("token"),!0):void 0:(console.log("need login"),this.$router.push("/login/"),!1)}}},u=d,c=(n("034f"),n("2877")),f=Object(c["a"])(u,s,i,!1,null,null,null);f.options.__file="App.vue";var h=f.exports,m=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("h1",[e._v("first vue crm")]),n("el-button",{on:{click:e.testSocket}},[e._v("Test socket")])],1)},g=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"crud"},[n("el-row",[n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{clearable:"",placeholder:"Поиск"},nativeOn:{keyup:function(t){return e.search(t)}},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}})],1),n("el-col",{attrs:{span:3,offset:21}},[e.actions.includes("create")?n("div",{staticClass:"crud__ctrl"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.create}},[e._v("Create")])],1):e._e()])],1),n("el-table",{attrs:{data:e.data,stripe:"",border:e.border||void 0,"row-style":e.rowStyle||void 0,"highlight-current-row":e.highlightCurrentRow},on:{expand:e.handleExpand,"row-click":e.handleRowClick,"row-dblclick":e.handleRowDblclick}},[e._t("prepend"),e._l(Object.keys(e.columns),function(t,a){return[t in e.fields&&e.fields[t].tableHidden?n("div",{key:a}):t in e.fields&&e.fields[t].options&&e.fields[t].formatter&&"function"===typeof e.fields[t].formatter?n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t].width||e.labelWidth,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                    "+e._s(e.fields[t].formatter(n.row,n.column,n.row[t]))+"\n                ")]}}])}):t in e.fields&&e.fields[t].multiple?n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t].width||e.labelWidth,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row[t],function(a){return n("div",[e._v("\n                        "+e._s((e.fields[t].options.find(function(e){return e.value===a})||"").label)+"\n                    ")])})}}])}):t in e.fields&&e.fields[t].options&&!e.fields[t].raw?n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t].width||e.labelWidth,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                    "+e._s((e.fields[t].options.find(function(e){return e.value===n.row[t]})||"").label)+"\n                ")]}}])}):t in e.fields&&e.fields[t].type===e.TYPES.date?n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t].width||e.labelWidth,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                    "+e._s(n.row[t]?n.row[t].slice(0,10):"")+"\n                ")]}}])}):t in e.fields&&e.fields[t].type===e.TYPES.datetime?n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t].width||e.labelWidth,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                    "+e._s(new Date(n.row[t]).toString())+"\n                ")]}}])}):n("el-table-column",{key:a,attrs:{label:e.columns[t],"min-width":e.fields[t]?e.fields[t].width:e.labelWidth,prop:t,"show-overflow-tooltip":""}})]}),e._t("default"),e.actions.includes("update")||e.actions.includes("destroy")?n("el-table-column",{attrs:{label:"Действия",width:"148",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.actions.includes("update")?n("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(n){n.stopPropagation(),e.update(t.row,t.$index)}}},[e._v("Изменить")]):e._e(),e.actions.includes("destroy")?n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){n.stopPropagation(),e.destroy(t.row,t.$index)}}},[e._v("Удалить")]):e._e()]}}])}):e._e()],2),n("el-dialog",{attrs:{title:"Детальное представление",size:e.detail.size,"close-on-click-modal":!1,visible:e.detail.visible,"show-close":!1},on:{open:e.handleOpen}},[e._l(Object.keys(e.labels),function(t,a){return n("el-row",{key:a,staticClass:"detail-row"},[n("el-col",{attrs:{span:6,offset:3},domProps:{innerHTML:e._s(e.labels[t])}}),t in e.fields&&e.fields[t].multiple?n("el-col",{attrs:{span:6,offset:3}},e._l(e.form[t],function(a){return n("div",[e._v("\n                    "+e._s((e.fields[t].options.find(function(e){return e.value===a})||"").label)+"\n                ")])}),0):t in e.fields&&e.fields[t].options?n("el-col",{attrs:{span:6,offset:3}},[e._v(e._s((e.fields[t].options.find(function(n){return n.value===e.form[t]})||"").label))]):n("el-col",{attrs:{span:6,offset:3}},[e._v(e._s(e.form[t]))])],1)}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"close"},on:{click:e.closeDetail}},[e._v("Закрыть")])],1)],2),n("el-dialog",{attrs:{title:e.dialog.title[e.dialog.status],size:e.dialog.size,"close-on-click-modal":!1,visible:e.dialog.visible,"show-close":!1},on:{open:e.handleOpen}},[n("el-form",{ref:"form",staticClass:"crud__form",class:{"crud__form--inline":e.inline},attrs:{model:e.form,rules:e.computedRules},nativeOn:{keyup:function(t){return"button"in t||13===t.keyCode?e.submit(t):null}}},[e._l(Object.keys(e.labels),function(t,a){return n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fields[t].cuHidden,expression:"!fields[key].cuHidden"}],key:a,attrs:{label:e.labels[t],prop:t,"label-width":e.labelWidth}},[e.fields[t].slot?e._t(e.fields[t].slot):e.fields[t].multiple?n("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.fields[t].disabled,placeholder:"",multiple:"",filterable:""},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}},e._l(e.fields[t].options,function(a,s){return n("el-option",{key:s,attrs:{label:a.label,value:a.value,disabled:e.fields[t].unique&&e.repeated(t,a.value,(e.updatingRow||"")[t])}})}),1):e.fields[t].options?n("el-select",{staticStyle:{width:"100%"},attrs:{disabled:e.fields[t].disabled,placeholder:"",filterable:""},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}},e._l(e.fields[t].options,function(a,s){return n("el-option",{key:s,attrs:{label:a.label,value:a.value,disabled:e.fields[t].unique&&e.repeated(t,a.value,(e.updatingRow||"")[t])}})}),1):e.fields[t].type===e.TYPES.date?n("el-date-picker",{attrs:{disabled:e.fields[t].disabled,type:"date",format:"dd-MM-yyyy","value-format":"yyyy-MM-dd"},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}}):e.fields[t].type===e.TYPES.datetime?n("el-date-picker",{attrs:{disabled:e.fields[t].disabled,type:"datetime"},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}}):e.fields[t].type===e.TYPES.text?n("el-input",{attrs:{disabled:e.fields[t].disabled,type:"textarea",resize:"none",maxlength:e.fields[t].length},nativeOn:{keyup:function(t){return"button"in t||13===t.keyCode?(t.stopPropagation(),e.doNothing(t)):null}},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}}):e.fields[t].type===e.TYPES.integer||e.fields[t].type===e.TYPES.float?n("el-input",{attrs:{disabled:e.fields[t].disabled,type:"number"},on:{change:function(n){e.handleNumberChange(t,n,e.fields[t].length)}},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,e._n(n))},expression:"form[key]"}}):n("el-input",{attrs:{disabled:e.fields[t].disabled,type:e.fields[t].protected?"password":"text",maxlength:e.fields[t].length},model:{value:e.form[t],callback:function(n){e.$set(e.form,t,n)},expression:"form[key]"}})],2)}),e._t("addon")],2),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"close"},on:{click:e.closeDialog}},[e._v("Закрыть")]),n("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("Отправить")])],1)],1),n("div",{staticClass:"block"},[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,25,50,100],"page-size":10,layout:"sizes, prev, pager, next",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)],1)},v=[],y=(n("6b54"),n("7514"),n("ade3")),k=n("be94"),_=["string","text","boolean","integer","float","date","datetime","objectid"],w=_.reduce(function(e,t,n){return Object(k["a"])({},e,Object(y["a"])({},t,t))},{}),$={props:{data:{required:!0,type:Array},form:{required:!0,type:Object},fields:{required:!0,type:Object},rules:Object,count:0,table:Object,size:{default:"large",type:String},labelWidth:{default:"100px",type:String},inline:{default:!1,type:Boolean},loading:{default:!1,type:Boolean},actions:{default:function(){return["create","destroy","update"]},type:Array},highlightCurrentRow:{default:!1,type:Boolean},rowStyle:Function,border:{type:Boolean,default:!0}},data:function(){return{showContactPickerModal:!1,currentPage:0,dialog:{status:0,visible:!1,title:{0:"Добавить новую запись",1:"Изменить запись"},size:this.inline?this.size:"small"},detail:{status:0,visible:!1,size:this.inline?this.size:"small"},updatingRow:null,searchStr:"",TYPES:w}},computed:{labels:function(){var e={},t=this.fields;for(var n in t)e[n]=t[n].label;return e},columns:function(){return this.table||this.labels},computedRules:function(){if(this.rules)return this.rules;var e={},t=this.fields;for(var n in t)t[n].rules&&(e[n]=t[n].rules.concat({pattern:/^\S.*?$/,message:"Бля херня какая то"}));return e}},methods:{doNothing:function(){},search:function(){this.$emit("search",this.searchStr)},create:function(){this.dialog.status=0,this.showDialog(),this.$emit("create")},update:function(e,t){this.dialog.status=1,this.updatingRow=e,this.showDialog(),this.$emit("update",e,t)},destroy:function(e,t){var n=this;this.$confirm("Удалить?","Подтверждение",{confirmButtonText:"OK",cancelButtonText:"Отмена",type:"warning"}).then(function(){n.$emit("destroy",e,t)}).catch(function(e){})},showDialog:function(){this.dialog.visible=!0,this.$emit("open")},closeDialog:function(){this.dialog.visible=!1,this.$emit("close")},showDetail:function(){console.log("crud show detail"),this.detail.visible=!0,this.$emit("detailOpen")},closeDetail:function(){this.detail.visible=!1,this.$emit("detailClose")},handleOpen:function(){this.$refs.form&&this.$refs.form.resetFields()},submit:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$emit("submit",e.dialog.status,e.closeDialog)})},repeated:function(e,t,n){return t!==n&&!!this.data.find(function(n){return n[e]===t})},handleExpand:function(e,t){this.$emit("expand",e,t)},handleRowClick:function(e,t,n){this.$emit("row-click",e,t,n)},handleRowDblclick:function(e,t){this.showDetail(),this.$emit("row-dblclick",e,t)},handleNumberChange:function(e,t,n){var a=this,s=(t.toString().length,t.toString().slice(0,n));this.$nextTick(function(){a.form[e]=s})},handleSizeChange:function(e){console.log("size changed",e),this.$emit("sizePerPageChanged",e)},handleCurrentChange:function(e){console.log("current changed",e),this.$emit("currentPageChanged",e)}}},C=$,S=(n("9878"),Object(c["a"])(C,b,v,!1,null,null,null));S.options.__file="Crud.vue";var x=S.exports,T={name:"home",components:{},data:function(){return{}},methods:{testSocket:function(){r.post("http://localhost:3000/init/")}}},O=T,j=Object(c["a"])(O,p,g,!1,null,null,null);j.options.__file="Home.vue";var E=j.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"admin"}},[n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/contact/"}},[e._v("Управление контактами")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/task/"}},[e._v("Управление задачами")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/edu/"}},[e._v("Образовательные учреждения")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/edu-type/"}},[e._v("Типы образовательных учреждений")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/event/"}},[e._v("Мероприятия")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("router-link",{attrs:{to:"/admin/type-add/"}},[e._v("Типы добавления")])],1)],1)],1)},D=[],z={name:"Admin"},A=z,F=(n("e69c"),Object(c["a"])(A,P,D,!1,null,"3e9134f7",null));F.options.__file="Admin.vue";var I=F.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],attrs:{data:this.$store.getters.edus,fields:this.$store.getters.edusFields,count:this.$store.getters.edus.length,form:e.form},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},U=[],N={name:"home",components:{Crud:x},data:function(){return{ent:"edu",form:{}}},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},R=N,H=Object(c["a"])(R,M,U,!1,null,null,null);H.options.__file="Edu.vue";var L=H.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{attrs:{data:this.$store.getters.EduTypes,fields:this.$store.getters.EduTypesFields,form:e.form,count:this.$store.getters.EduTypes.length},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},Y=[],W=(n("7f7f"),n("20d6"),n("1c4c"),n("ac6a"),n("5df3"),n("f400"),n("2f62")),q={contact:{origin:{label:"Идентификатор контакта",type:"string",cuHidden:!0},surname:{label:"Фамилия",type:"string"},name:{label:"Имя",type:"string"},patro:{label:"Отчество",type:"string"},level:{label:"Класс",type:"integer"},phone:{label:"Телефон",type:"string"},email:{label:"Почта",type:"string"},vk:{label:"ВК",type:"string"},birthday:{label:"Дата рождения",type:"date",tableHidden:!0},address:{label:"Адрес",type:"string",tableHidden:!0},datetime:{label:"Добавлен",type:"datetime",tableHidden:!0,cuHidden:!0},edu_id:{label:"Школа",type:"objectid",options:[],ent:"edu"},status_id:{label:"Статус",type:"objectid",options:[],ent:"statusContact"},user_id:{label:"Добавил",type:"objectid",options:[],cuHidden:!0,ent:"user"},event_ids:{label:"Мероприятия",type:"objectid",options:[],multiple:!0,ent:"event"},type_id:{label:"Тип добавления",type:"objectid",options:[],ent:"typeAdd"}},edu:{name:{label:"Название",type:"String"},type_id:{label:"Тип",type:"objectid",options:[],ent:"eduType"}},eduType:{name:{label:"Название",type:"String"}},statusContact:{name:{label:"Название",type:"String"}},statusTask:{name:{label:"Название",type:"String"}},event:{name:{label:"Название",type:"string"},date:{label:"Дата",type:"date"}},typeAdd:{name:{label:"Название",type:"String"}},task:{name:{label:"Имя",type:"string"},message:{label:"Текст",type:"string"},add_datetime:{label:"Добавлена",type:"datetime",tableHidden:!0,cuHidden:!0},end_datetime:{label:"Окончание",type:"datetime"},status_id:{label:"Статус",type:"objectid",options:[],ent:"statusTask"},user_id:{label:"Исполнители",type:"objectid",options:[],multiple:!0,ent:"user"},contact_ids:{label:"Контакты",type:"objectid",options:[],multiple:!0,ent:"contact"}}},J=q;a["default"].use(W["a"]);var K=new W["a"].Store({state:{contact:{contact:[],fields:{}},edu:{edu:[],fields:{}},eduType:{eduType:[],fields:J.eduType},statusContact:{statusContact:[],fields:J.statusContact},statusTask:{statusTask:[],fields:J.statusTask},task:{task:[],fields:{}},event:{event:[],fields:J.event},typeAdd:{typeAdd:[],fields:J.typeAdd},user:{user:[],fields:{}}},getters:{originalContacts:function(e){var t=e.contact,n=new Map;return t.contact.reverse().forEach(function(e){n.has(e.origin)||n.set(e.origin,e)}),Array.from(n.values())},allContacts:function(e){return e.contact.contact},allContactsFields:function(e){return e.contact.fields},edus:function(e){return e.edu.edu},edusFields:function(e){return e.edu.fields},EduTypes:function(e){return e.eduType.eduType},EduTypesFields:function(e){return e.eduType.fields},statusesTask:function(e){return e.statusTask.statusTask},statusesTaskFields:function(e){return e.statusTask.fields},statusesContact:function(e){return e.statusContact.statusContact},statusesContactFields:function(e){return e.statusContact.fields},tasks:function(e){return e.task.task},tasksFields:function(e){return e.task.fields},events:function(e){return e.event.event},eventsFields:function(e){return e.event.fields},typeAdds:function(e){return e.typeAdd.typeAdd},typeAddsFields:function(e){return e.typeAdd.fields}},mutations:{INIT:function(e,t){e[t.ent][t.ent]=t.data},ADD:function(e,t){e[t.ent][t.ent].push(t.data)},DELETE:function(e,t){console.log(t);var n=e[t.ent][t.ent].findIndex(function(e,n){return e._id===t.data});e[t.ent][t.ent].splice(n,1)},UPDATE:function(e,t){var n=e[t.ent][t.ent].findIndex(function(e,n){return e._id===t.data._id});e[t.ent][t.ent].splice(n,1,t.data)},SET_FIELDS:function(e,t){e[t.ent].fields=t.data}},actions:{socket_add:function(e,t){e.commit("ADD",t),e.dispatch("updateFields")},socket_init:function(e,t){e.commit("INIT",t)},socket_delete:function(e,t){e.commit("DELETE",t),e.dispatch("updateFields")},socket_update:function(e,t){e.commit("UPDATE",t),e.dispatch("updateFields")},updateFields:function(e,t){var n=this,a=function(t){var a=function(a){if(J[t][a].options){var s=J[t][a].ent;J[t][a].options=[],n.state[s][s].forEach(function(e){"user_id"===a?J[t][a].options.push({value:e._id,label:e.username}):"contact_ids"===a?J[t][a].options.push({value:e._id,label:e.surname+" "+e.name+" "+e.patro}):J[t][a].options.push({value:e._id,label:e.name})}),e.commit("SET_FIELDS",{ent:t,data:J[t]})}};for(var s in J[t])a(s)};for(var s in J)a(s)}}}),G={name:"home",components:{Crud:x},data:function(){return{ent:"eduType",form:{}}},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},Q=G,V=Object(c["a"])(Q,B,Y,!1,null,null,null);V.options.__file="EduType.vue";var X=V.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{attrs:{data:this.$store.getters.events,fields:this.$store.getters.eventsFields,count:this.$store.getters.events.length,form:e.form},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},ee=[],te={name:"home",components:{Crud:x},data:function(){return{ent:"event",form:{}}},created:function(){},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},ne=te,ae=Object(c["a"])(ne,Z,ee,!1,null,null,null);ae.options.__file="Event.vue";var se=ae.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{attrs:{data:this.$store.getters.typeAdds,fields:this.$store.getters.typeAddsFields,form:e.form,count:this.$store.getters.typeAdds.length},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},oe=[],le={name:"home",components:{Crud:x},data:function(){return{ent:"typeAdd",form:{}}},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},re=le,de=Object(c["a"])(re,ie,oe,!1,null,null,null);de.options.__file="TypeAdd.vue";var ue=de.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],attrs:{data:e.data,fields:this.$store.getters.allContactsFields,count:e.count,form:e.form},on:{search:e.handleSearch,create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit,"row-dblclick":e.handleRowDblclick,sizePerPageChanged:e.handlerSizePerPageChanged,currentPageChanged:e.handlerCurrentPageChanged}})],1)},fe=[],he=(n("386d"),{name:"Contact",components:{Crud:x},asyncComputed:{data:{get:function(){var e=this;return this.search?(this.page=1,this.$search(this.search,this.$store.getters.originalContacts,this.fuseOptions).then(function(t){return e.count=t.length,t.slice((e.page-1)*e.pageSize,e.page*e.pageSize)}).catch(function(e){console.log(e)})):(this.count=this.$store.getters.originalContacts.length,this.$store.getters.originalContacts.slice((this.page-1)*this.pageSize,this.page*this.pageSize))},default:[]}},data:function(){return{ent:"contact",pageSize:10,page:1,count:1,form:{},loading:!0,search:"",fuseOptions:{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:["surname","name","patro"]}}},created:function(){this.dataInit()},methods:{handleCreate:function(){},handleSearch:function(e){this.search=e},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){for(var n in this.form.datetime=new Date,this.form.user_id=this.$session.get("id"),0===e?this.form.origin=this.getRandom():this.form._id=null,this.form)""===this.form[n]&&(this.form[n]=null);this.$socket.emit("add",{ent:this.ent,data:this.form}),t()},handleRowDblclick:function(e,t){this.form=Object(k["a"])({},e),console.log(e,t)},getRandom:function(){var e=Math.floor(11*Math.random()),t=Math.floor(1e6*Math.random());return String.fromCharCode(e)+t},dataInit:function(){},handlerCurrentPageChanged:function(e){this.page=e,this.dataInit()},handlerSizePerPageChanged:function(e){this.pageSize=e,this.dataInit()}}}),me=he,pe=Object(c["a"])(me,ce,fe,!1,null,null,null);pe.options.__file="Contact.vue";var ge=pe.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],attrs:{data:this.$store.getters.tasks,fields:this.$store.getters.tasksFields,count:this.$store.getters.tasks.length,form:e.form},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},ve=[],ye={name:"Contact",components:{Crud:x},data:function(){return{ent:"task",form:{}}},created:function(){this.dataInit()},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())},dataInit:function(){}}},ke=ye,_e=Object(c["a"])(ke,be,ve,!1,null,null,null);_e.options.__file="Task.vue";var we=_e.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"sender"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.data},on:{"select-all":e.handleSelectAll,"selection-change":e.handleSelectionChanged}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{property:"surname",label:"Фамилия"}}),n("el-table-column",{attrs:{property:"name",label:"Имя"}}),n("el-table-column",{attrs:{property:"patro",label:"Отчество"}}),n("el-table-column",{attrs:{property:"phone",label:"Телефон"}}),n("el-table-column",{attrs:{property:"email",label:"Email"}}),n("el-table-column",{attrs:{property:"level",label:"Класс"}}),n("el-table-column",{attrs:{property:"address",label:"Адрес"}})],1),n("el-row",{staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:2,offset:9}},[e._v("Email")]),n("el-col",{attrs:{span:4}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:!this.addressbookId,expression:"!this.addressbookId"}],on:{click:e.sendEmail}},[e._v("Добавить адреса")])],1),n("el-col",{attrs:{span:4}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:this.addressbookId,expression:"this.addressbookId"}],attrs:{type:"danger"},on:{click:e.startCampaign}},[e._v("Отправить письма")])],1)],1)],1)},Ce=[],Se={name:"Sender",data:function(){return{data:[],selection:[],forSend:[],loading:!0,addressbookId:"",readyForSend:!1,fields:{surname:{label:"Фамилия",type:"string"},name:{label:"Имя",type:"string"},patro:{label:"Отчество",type:"string"},level:{label:"Класс",type:"integer"},phone:{label:"Телефон",type:"string",tableHidden:!0},email:{label:"Почта",type:"string",tableHidden:!0},vk:{label:"ВК",type:"string"}}}},created:function(){var e=this;r.get("/contacts-original/").then(function(t){var n=t.data;e.data=n,e.loading=!1})},methods:{handleSelectAll:function(){},handleSelectionChanged:function(e){this.selection=e},sendEmail:function(){var e=this;this.forSend=[],this.selection.length>0?(this.selection.forEach(function(t){t.id;var n=t.email,a=t.name,s=t.surname;e.forSend.push({email:n,variables:{name:a+" "+s}})}),r.post("/send-emails/",this.forSend).then(function(t){e.addressbookId=t.data,console.log(t)}).catch(function(e){console.log(e)})):this.$alert("Вы никого не выбрали")},getAddressboolAviable:function(){},startCampaign:function(){var e=this;r.post("/get-addressbook-aviable/",{addressbookId:this.addressbookId}).then(function(t){var n=t.data;n=n[0],0==n.status?r.post("/start-campaign/",{emails:e.forSend,addressbookId:e.addressbookId}).then(function(e){var t=e.he;console.log("good",t)}):e.$alert(n.status_explain)})}}},xe=Se,Te=(n("451b"),Object(c["a"])(xe,$e,Ce,!1,null,"499e2f02",null));Te.options.__file="Sender.vue";var Oe=Te.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],attrs:{data:e.data,fields:this.$store.getters.allContactsFields,count:e.count,form:e.form},on:{search:e.handleSearch,create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit,"row-dblclick":e.handleRowDblclick,sizePerPageChanged:e.handlerSizePerPageChanged,currentPageChanged:e.handlerCurrentPageChanged}})],1)},Ee=[],Pe={name:"Contact",components:{Crud:x},asyncComputed:{data:{get:function(){var e=this;return this.search?(this.page=1,this.$search(this.search,this.$store.getters.allContacts,this.fuseOptions).then(function(t){return e.count=t.length,t.slice((e.page-1)*e.pageSize,e.page*e.pageSize)}).catch(function(e){console.log(e)})):(this.count=this.$store.getters.allContacts.length,this.$store.getters.allContacts.slice((this.page-1)*this.pageSize,this.page*this.pageSize))},default:[]}},data:function(){return{ent:"contact",pageSize:10,page:1,count:1,form:{},loading:!0,search:"",fuseOptions:{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:["surname","name","patro"]}}},created:function(){this.dataInit()},methods:{handleCreate:function(){},handleSearch:function(e){this.search=e},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){for(var n in this.form.datetime=new Date,this.form.user_id=this.$session.get("id"),0===e?this.form.origin=this.getRandom():this.form._id=null,this.form)""===this.form[n]&&(this.form[n]=null);this.$socket.emit("add",{ent:this.ent,data:this.form}),t()},handleRowDblclick:function(e,t){this.form=Object(k["a"])({},e),console.log(e,t)},getRandom:function(){var e=Math.floor(11*Math.random()),t=Math.floor(1e6*Math.random());return String.fromCharCode(e)+t},dataInit:function(){},handlerCurrentPageChanged:function(e){this.page=e,this.dataInit()},handlerSizePerPageChanged:function(e){this.pageSize=e,this.dataInit()}}},De=Pe,ze=Object(c["a"])(De,je,Ee,!1,null,null,null);ze.options.__file="AllContact.vue";var Ae=ze.exports,Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{attrs:{id:"login"}},[n("el-col",{attrs:{span:8,offset:8}},[n("el-form",[n("h5",{staticStyle:{color:"red"}},[e._v(e._s(e.error))]),n("el-input",{attrs:{type:"text",name:"username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("el-input",{attrs:{type:"password",name:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("el-button",{staticClass:"primary",attrs:{round:""},on:{click:e.auth}},[e._v("Войти")])],1)],1)],1)},Ie=[],Me={name:"Login",data:function(){return{username:"",password:"",error:""}},created:function(){},methods:{auth:function(){var e=this;r.post("http://crmback.na4u.ru/auth/",{username:this.username,password:this.password}).then(function(t){var n=t.data;n.failed?e.error="Неверный логин или пароль":(e.$session.set("username",n.username),e.$session.set("id",n._id),e.$session.set("nasyanika",n.is_staff),e.$router.push("/"))})}}},Ue=Me,Ne=(n("0601"),Object(c["a"])(Ue,Fe,Ie,!1,null,"6f8ba3d6",null));Ne.options.__file="Login.vue";var Re=Ne.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},Le=[],Be={name:"Logout",created:function(){this.$session.destroy(),this.$router.push("/login/")}},Ye=Be,We=(n("272b"),Object(c["a"])(Ye,He,Le,!1,null,"35037c74",null));We.options.__file="Logout.vue";var qe=We.exports,Je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{attrs:{data:this.$store.getters.statusesContact,fields:this.$store.getters.statusesContactFields,count:this.$store.getters.statusesContact.length,form:e.form},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},Ke=[],Ge={name:"home",components:{Crud:x},data:function(){return{ent:"statusContact",form:{}}},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},Qe=Ge,Ve=Object(c["a"])(Qe,Je,Ke,!1,null,null,null);Ve.options.__file="StatusContact.vue";var Xe=Ve.exports,Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"edu-admin"}},[n("crud",{attrs:{data:this.$store.getters.statusesTask,fields:this.$store.getters.statusesTaskFields,count:this.$store.getters.statusesTask.length,form:e.form},on:{create:e.handleCreate,update:e.handleUpdate,destroy:e.handleDestroy,submit:e.handleSubmit}})],1)},et=[],tt={name:"home",components:{Crud:x},data:function(){return{ent:"statusTask",form:{}}},methods:{handleCreate:function(){},handleUpdate:function(e,t){this.form=Object(k["a"])({},e)},handleDestroy:function(e,t){this.$socket.emit("delete",{ent:this.ent,data:e._id})},handleSubmit:function(e,t){0===e?(this.$socket.emit("add",{ent:this.ent,data:this.form}),t()):1===e&&(this.$socket.emit("update",{ent:this.ent,data:this.form}),t())}}},nt=tt,at=Object(c["a"])(nt,Ze,et,!1,null,null,null);at.options.__file="StatusTask.vue";var st=at.exports,it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"task-manager"}},[n("el-button",[e._v("Добавить контакт")]),n("el-table",{ref:"task-table",attrs:{data:this.$store.getters.tasks}},[n("el-table-column",{attrs:{label:"Name",property:"name",width:"120"}})],1)],1)},ot=[],lt={name:"TaskManager"},rt=lt,dt=(n("c349"),Object(c["a"])(rt,it,ot,!1,null,"8fea48ca",null));dt.options.__file="TaskManager.vue";var ut=dt.exports;a["default"].use(m["a"]);var ct=new m["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:E},{path:"/login/",name:"login",component:Re},{path:"/logout/",name:"logout",component:qe},{path:"/admin/",name:"admin",component:I},{path:"/sender/",name:"sender",component:Oe},{path:"/admin/contact/",name:"contact-admin",component:ge},{path:"/admin/all-contact/",name:"all-contact-admin",component:Ae},{path:"/admin/task/",name:"task-admin",component:we},{path:"/admin/edu/",name:"edu-admin",component:L},{path:"/admin/status-contact/",name:"status-contact-admin",component:Xe},{path:"/admin/edu-type/",name:"edu-type-admin",component:X},{path:"/admin/status-task/",name:"status-task-admin",component:st},{path:"/admin/event/",name:"event-admin",component:se},{path:"/admin/type-add/",name:"type-add-admin",component:ue},{path:"/work-area/task-manager/",name:"task-manager",component:ut}]}),ft=n("9483");Object(ft["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ht=n("0628"),mt=n.n(ht),pt=n("5c96"),gt=n.n(pt),bt=(n("0fae"),n("dccd")),vt=n.n(bt),yt=n("5132"),kt=n.n(yt),_t=n("a7fe"),wt=n.n(_t),$t=n("dc96"),Ct=n.n($t),St=n("9437"),xt=n.n(St);a["default"].use(new kt.a({debug:!0,connection:"http://crmback.na4u.ru",vuex:{store:K,actionPrefix:"socket_"}})),a["default"].use(xt.a),a["default"].use(Ct.a),a["default"].use(mt.a),a["default"].use(gt.a,{locale:vt.a}),a["default"].use(wt.a,l.a),a["default"].config.productionTip=!1,new a["default"]({router:ct,store:K,render:function(e){return e(h)}}).$mount("#app")},"64a9":function(e,t,n){},"6b30":function(e,t,n){},9859:function(e,t,n){},9878:function(e,t,n){"use strict";var a=n("3f36"),s=n.n(a);s.a},b48a:function(e,t,n){},c349:function(e,t,n){"use strict";var a=n("47e2"),s=n.n(a);s.a},e69c:function(e,t,n){"use strict";var a=n("b48a"),s=n.n(a);s.a}});
//# sourceMappingURL=app.cdc05daf.js.map